{% extends "base.html" %}

{% block title %}واریزی - داشبورد{% endblock %}

{% block content %}
<div class="card" id="deposit">
  <h2>واریزی</h2>
  <div class="totals">
    <div class="pill">واریزی کل (USD): <strong>{{ '%.2f' % total_usd }}</strong> $</div>
    <div class="pill">واریزی کل (تومان): <strong>{{ '{:,.0f}'.format(total_toman) }}</strong></div>
  </div>
  <form method="post" action="{{ url_for('panel_bp.panel_add') }}">
    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
    <div class="form-grid">
      <label>
        مقدار BTC
        <input type="number" step="0.00000001" min="0" name="amount_btc" required inputmode="decimal" placeholder="مثلاً 0.005">
      </label>
      <label>
        قیمت دلار هر BTC
        <input type="number" step="0.01" min="0" name="price_usd_per_btc" required inputmode="decimal" placeholder="مثلاً 61234.50">
      </label>
    </div>
    <div class="section-actions" style="margin-top:12px; display:flex; gap:10px;">
      <button type="submit" class="btn btn-primary">ثبت واریزی</button>
    </div>
  </form>
</div>
<div class="card" id="deposits-list">
  <h2>آخرین واریزی‌ها</h2>
  <div id="dp_mobile" class="row" style="display:none;"></div>
</div>
<script>
  (function(){
    var isMobile = window.matchMedia('(max-width: 640px)');
    var listWrap = document.getElementById('deposits-list');
    var mob = document.getElementById('dp_mobile');
    function apply(){
      if (!listWrap || !mob) return;
      var mobile = isMobile.matches;
      mob.style.display = mobile ? '' : 'none';
      // این صفحه دیتای لیست واریزی‌ها را به‌صورت جدول ندارد؛
      // اگر بعداً API لیست را اضافه کردیم، اینجا کارت‌های موبایل رندر می‌شود.
    }
    apply();
    isMobile.addEventListener('change', apply);
  })();
</script>
{% endblock %}
